# 第七章 网络安全基础知识

[toc]

## 网络安全问题概述

- 技术或服务提供者被动应对
- 安全性威胁：防止通过改变知识状态造成不希望的后果（如窃取或破坏信息）
  - 安全攻击目标：属主+知识（主体+客体）
  - 主动攻击：篡改（更改报文流）、恶意程序、拒绝服务（发送大量分组导致无法正常服务甚至瘫痪）
  - 被动攻击：窃听通信内容，如截获。不干扰信息流，又称流量分析
  - 分布式拒绝服务DDoS：各网站集中攻击一个服务器，耗尽资源和网络带宽（破坏正常用户连通性）
- 四种基本安全服务
  - 机密性：数据加密，使数据包可获取但不可读取
  - 完整性：通过“缩影”保证篡改能被发现
  - 真实性：接收方通过“签名”确认发信方
  - 不可抵赖性：签名不可能被伪造
- 密码：信息的编码和解码手段，使不知晓口令的第三方无法用足够的计算资源（枚举破解）破译
  - 理论上不可破（无论获得多少密文都不可破）、计算上安全（代价过大）
  - 明文通过加密算法E和加密密钥K变成密文；解密算法D和解密密钥K解出明文
  - 加密密钥和解密密钥由密钥中心提供，需要通过安全信道传送，可以不同
  - 可以实现机密性，但无法实现完整性

## 加密体制

- 流密码（如移位密码）
- 分组密码（对称密钥密码体制、公钥（非对称）密码体制）

### 对称密钥密码机制

- 加密密钥与解密密钥相同（一对节点间）
- 效率高、易实现。但密钥的分发和管理不易（安全性、管理复杂性）
- n个节点需要O(n2)个密钥
- 数据加密标准DES。算法公开，保密性取决于密钥的保密。但专用芯片使56位DES不再安全
- 改进：三重DES。密钥1加密、密钥2解密、密钥1加密

### 公钥密码体制

- 加密密钥与解密密钥不同
- 加密密钥（公钥）PK公开，解密密钥（私钥）SK保密，由密钥产生器生成
- 加密算法和解密算法公开，由公钥推出私钥计算不可行
- 静态性和可靠性更好
- n个节点需要O(n)个密钥
- 发送者用接收者公钥加密，接收者用**对应**私钥解密
- 加密和解密互逆
- 加密密钥不能用于解密
- 效率较低但安全性更好
- 密钥分配协议实现

## 数字签名

- 源认证（接收者可以确认发送者）、不可抵赖性（发送者不能抵赖）、防伪造篡改（他人无法伪造）
- 用私有密钥加密的信息，可以用公开密钥解密
- 可以通过加密实现秘密通信，并追加数字签名

## 认证

- 对抗主动攻击（篡改和伪造）的鉴别方法
- 大部分消息无需加密，所以认证方式应简单
- 授权：过程权限是否被允许。认证：检查真伪

### 消息认证

- 包括端点认证（主体）和消息完整性认证（客体）
- 消息较长时数字签名实现消息认证复杂度高，负担大
- 采用密码散列函数
  - 输入长度任意，输出（散列值）长度固定。
  - 不同输入可能碰撞
  - 单向性
  - 寻找同样散列值的不同消息在计算上不可行
  - MD5和SHA-1（效率略低，抗穷举性更高）
  - 可以防篡改，不能防伪造（因为不包括用户相关信息）
- 消息认证码：加密散列值（对称密钥）或签名散列值（公钥）
  - 同时可以防伪造，但对称密钥不能防抵赖（存在密钥泄露），公钥体制可以（私钥仅有发送方持有）
  - 只需对散列值加密
  - 使消息摘要可以被安全送达

### 实体认证

- 即端点认证，持续时间内只需要一次
- 可以用对称密钥简单实现
  - 存在重放攻击：截获后重发，甚至追加IP欺骗
- 动态挑战字Nonce：不重复的大随机数，使截获方无法重复使用
- 公钥密码体制中可以对nonce签名认证
  - 在公钥获取上存在被攻击可能
- 中间人攻击（从而公钥分发必须依赖可靠第三方）

## 密钥分配

- 网外分配和网内分配；对称密钥分配和非对称密钥分配
- 密钥分配中心KDC（可靠第三方）
  - 分配一个仅使用一次的临时密钥
  - 通信双方都是KDC的登记用户，且保存了与KDC的通讯主密钥
  - 密钥分配协议Kerberos基于AES标准
- 对称密钥分配：
  - A向KDC申请公钥，KDC用随机数产生本次密钥，向A发送用A的主密钥加密的（本次密钥，票据）消息
  - A解密后向B发送票据，B解密得到本次密钥
- 非对称密钥分配CA（可靠第三方）
  - 任何用户都可以通过CA的公钥来验证其消息的数字签名

## 互联网使用的安全协议

### 网络层安全协议

- 扩展报头或选项、传输消息摘要、签名等

### 传输层安全协议

- 安全套接字层SSL
  - 主要用于HTTP（调用时成为https）
  - 作用在端系统应用层的**HTTP和传输层之间**，为TCP传输提供安全
  - 发送方加密数据后送往TCP套接字，接收方从TCP套接字读取并解密后交付应用层
- 传输层安全TLS
  - 基于SSL
- 建立在TCP上，与应用层协议无关
- SSL的安全服务
  - SSL服务器认证
  - SSL客户认证
  - SSL加密会话（加密传输、完整校验）

### 应用层安全协议

- PGP协议
  - 综合MD5，RSA等协议
  - 提供电子邮件的安全性、发送方认证、消息完整性
  - 发送方额外持有一个一次性密钥。首先散列得到消息摘要，用私钥加密得到消息验证码MAC，拼接成扩展邮件。再用一次性密钥加密，加密后用B的公钥加密一次性密钥并带入加密后邮件并发送

## 系统安全与安全防护思路的变化

- 防护目标：从通道安全到数据安全
- 识别检测能力：大数据和AI来自适应检测、行为检测
- 安全策略：静态部署到动态生成
- 平等自治、自主可控、按需部署

### 防火墙

- 软硬件构成的特数编程的路由器，实施网络间自定义访问控制策略
- 防火墙内为可信网络，外为不可信网络
- 阻止或放行某些类型的通信量进出
- 分组过滤路由器
  - 根据过滤规则转发或丢弃进出分组
  - 基于网络层或传输层首部信息
  - 可以有状态（跟踪连接）或无状态（独立处理每个分组）
- 应用网关/代理服务器
  - 应用层消息中继
  - 基于应用层数据过滤和高层用户认证
  - 缺点：每种应用需要不同应用网关/转发处理报文的负担较重/对应用程序不透明，需要专门配置网关地址

### 入侵检测系统IDS

- 在入侵开始后尽快阻止入侵
- 误报率通常较高
- 能检测网络映射、端口扫描、DoS攻击、蠕虫和病毒、系统漏洞攻击等
- 基于特征的IDS
  - 只能检测已知攻击
  - 人工生成和维护已知攻击标志性特征的数据库
  - 主流部署
- 基于异常的IDS
  - 观察正常运行的网络流量学习正常、发现异常
